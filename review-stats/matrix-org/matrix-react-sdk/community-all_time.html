<!DOCTYPE html>
<html>
    <head>
        <title>matrix-org/matrix-react-sdk</title>
        <link rel="stylesheet" href="../../../res/style.css" />
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300&display=swap" rel="stylesheet">
    </head>
    <body class='index'>
        <h1>matrix-org/matrix-react-sdk review stats (Community PRs)</h1>
        <p>For team <code>element-web</code></p>

        <h2>Volume of PRs put up for review</h2>
        <p>Organized by the week in which review was first requested.</p>
        <div class='canvas'>
            <canvas id="prVolume"></canvas>
        </div>


        <h2>Days between opening and first review request</h2>
        <p>Organized by the week in which review was first requested.</p>
        <div class='canvas'>
            <canvas id="openToReviewRequest"></canvas>
        </div>


        <h2>Days between the first review request and first review</h2>
        <p>Organized by the week in which review was first requested.</p>
        <div class='canvas'>
            <canvas id="firstReview"></canvas>
        </div>


        <h2>Days between the first review request and first approving review</h2>
        <p>Organized by the week in which review was first requested.</p>
        <div class='canvas'>
            <canvas id="approvingReview"></canvas>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" integrity="sha512-qTXRIMyZIFb8iQcfjXWCO8+M5Tbc38Qi5WzdPOYZHIlZpzBHG3L3by84BBBOiRGiEb7KKtAOAs5qYdUiZiQNNQ==" crossorigin="anonymous"></script>

        <script type="text/javascript">const byWeekData = {"2018-06-24":{"openToReviewRequest":[0,0,0,0,0],"reviewRequestToFirst":[1,0,0,0,0],"reviewRequestToApproved":[1,0,0,0,0]},"2018-07-01":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2018-12-16":{"openToReviewRequest":[3],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2018-12-23":{"openToReviewRequest":[4,3],"reviewRequestToFirst":[4,4],"reviewRequestToApproved":[4,4]},"2018-12-30":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2019-02-17":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2019-03-24":{"openToReviewRequest":[3,0,1],"reviewRequestToFirst":[0,0,0],"reviewRequestToApproved":[0,0,0]},"2019-03-31":{"openToReviewRequest":[4],"reviewRequestToFirst":[0],"reviewRequestToApproved":[1]},"2019-04-07":{"openToReviewRequest":[0],"reviewRequestToFirst":[3],"reviewRequestToApproved":[7]},"2019-04-14":{"openToReviewRequest":[0,0],"reviewRequestToFirst":[0,1],"reviewRequestToApproved":[0,1]},"2019-08-25":{"openToReviewRequest":[97],"reviewRequestToFirst":[0],"reviewRequestToApproved":[1]},"2019-05-26":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2019-09-22":{"openToReviewRequest":[0],"reviewRequestToFirst":[2],"reviewRequestToApproved":[2]},"2019-11-03":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2019-11-24":{"openToReviewRequest":[0],"reviewRequestToFirst":[4],"reviewRequestToApproved":[4]},"2020-01-05":{"openToReviewRequest":[7,0,0],"reviewRequestToFirst":[0,0,3],"reviewRequestToApproved":[0,3,3]},"2020-01-12":{"openToReviewRequest":[0,0,0],"reviewRequestToFirst":[2,45,0],"reviewRequestToApproved":[2,45,1]},"2020-01-19":{"openToReviewRequest":[0,0,0,0],"reviewRequestToFirst":[0,0,0,0],"reviewRequestToApproved":[1,0,0,0]},"2020-03-01":{"openToReviewRequest":[43,0,0,0],"reviewRequestToFirst":[0,0,0,0],"reviewRequestToApproved":[0,0,1,0]},"2020-01-26":{"openToReviewRequest":[0,0,0,0,0,0,0],"reviewRequestToFirst":[0,0,0,0,3,0,0],"reviewRequestToApproved":[0,0,0,0,3,0,0]},"2020-02-02":{"openToReviewRequest":[0,0,0,0],"reviewRequestToFirst":[2,0,3,0],"reviewRequestToApproved":[2,0,3,0]},"2020-02-09":{"openToReviewRequest":[0,0,0,0,0,0],"reviewRequestToFirst":[0,0,0,0,0,0],"reviewRequestToApproved":[1,0,0,0,0,0]},"2020-07-19":{"openToReviewRequest":[160,0,0],"reviewRequestToFirst":[4,7,0],"reviewRequestToApproved":[4,8,0]},"2020-02-16":{"openToReviewRequest":[0,0],"reviewRequestToFirst":[0,2],"reviewRequestToApproved":[1,2]},"2020-02-23":{"openToReviewRequest":[0,0,0,0],"reviewRequestToFirst":[0,0,0,1],"reviewRequestToApproved":[0,0,0,1]},"2020-03-08":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-03-15":{"openToReviewRequest":[0],"reviewRequestToFirst":[2],"reviewRequestToApproved":[2]},"2020-03-22":{"openToReviewRequest":[0,0,0,0],"reviewRequestToFirst":[0,0,1,0],"reviewRequestToApproved":[1,0,1,0]},"2020-04-12":{"openToReviewRequest":[20,3],"reviewRequestToFirst":[16,3],"reviewRequestToApproved":[16,3]},"2020-03-29":{"openToReviewRequest":[1],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-04-05":{"openToReviewRequest":[0,0],"reviewRequestToFirst":[0,4],"reviewRequestToApproved":[0,4]},"2020-05-24":{"openToReviewRequest":[51,0,0],"reviewRequestToFirst":[5,7,5],"reviewRequestToApproved":[5,20,5]},"2020-04-19":{"openToReviewRequest":[8,0,0,0],"reviewRequestToFirst":[1,0,5,0],"reviewRequestToApproved":[1,0,5,0]},"2020-05-31":{"openToReviewRequest":[46,0,0,0,0],"reviewRequestToFirst":[3,0,1,0,1],"reviewRequestToApproved":[3,0,13,0,1]},"2020-04-26":{"openToReviewRequest":[0,0,0],"reviewRequestToFirst":[0,1,5],"reviewRequestToApproved":[0,1,5]},"2020-05-03":{"openToReviewRequest":[0,0],"reviewRequestToFirst":[0,0],"reviewRequestToApproved":[0,0]},"2020-05-10":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-06-14":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-06-28":{"openToReviewRequest":[0,0],"reviewRequestToFirst":[0,9],"reviewRequestToApproved":[2,9]},"2020-07-12":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-08-16":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-09-06":{"openToReviewRequest":[9],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-08-30":{"openToReviewRequest":[0],"reviewRequestToFirst":[6],"reviewRequestToApproved":[7]},"2020-09-20":{"openToReviewRequest":[20,0],"reviewRequestToFirst":[6,7],"reviewRequestToApproved":[6,33]},"2020-10-04":{"openToReviewRequest":[9,0,0],"reviewRequestToFirst":[1,0,0],"reviewRequestToApproved":[9,0,6]},"2020-09-27":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-10-11":{"openToReviewRequest":[0],"reviewRequestToFirst":[0],"reviewRequestToApproved":[0]},"2020-10-18":{"openToReviewRequest":[0],"reviewRequestToFirst":[4],"reviewRequestToApproved":[4]},"2020-10-25":{"openToReviewRequest":[3,1,0,0],"reviewRequestToFirst":[6,0,6,5],"reviewRequestToApproved":[6,0,6,5]},"2020-11-08":{"openToReviewRequest":[0,0],"reviewRequestToFirst":[0,12],"reviewRequestToApproved":[0,12]}};</script>

        <script type="text/javascript">
        const orderedWeeks = Object.keys(byWeekData).map(w => moment(w)).sort((a, b) => a - b).map(w => w.format('YYYY-MM-DD'));

        const maxOpts = {
            label: 'Maximum time',
            borderColor: '#e76f51',
            backgroundColor: '#e76f51',
            fill: false,
        };
        const minOpts = {
            label: 'Minimum time',
            borderColor: '#2a9d8f',
            backgroundColor: '#2a9d8f',
            fill: false,
        };
        const avgOpts = {
            label: 'Average time',
            borderColor: '#3d405b',
            backgroundColor: '#3d405b',
            fill: false,
        };

        const chartOpts = {
            legend: {
                position: 'bottom',
            },
            tooltips: {
                mode: "x",
            },
            scales: {
                xAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Week',
                    },
                    ticks: {
                        autoSkip: true,
                        maxRotation: 50,
                        minRotation: 50,
                    },
                }],
                yAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Days',
                    },
                    ticks: {
                        beginAtZero: true,
                    }
                }],
            },
        };

        const volCtx = document.getElementById("prVolume").getContext('2d');
        const volChart = new Chart(volCtx, {
            type: 'line',
            data: {
                labels: orderedWeeks,
                datasets: [{
                    data: orderedWeeks.map(w => byWeekData[w].openToReviewRequest.length),
                    ...avgOpts, // steal colours
                    label: '# of PRs',
                }],
            },
            options: {
                ...chartOpts,
                scales: {
                    yAxes: [{
                        scaleLabel: {
                            display: true,
                            labelString: 'Number of PRs',
                        },
                        ticks: {
                            beginAtZero: true,
                        }
                    }]
                }
            },
        });

        const openCtx = document.getElementById("openToReviewRequest").getContext('2d');
        const openChart = new Chart(openCtx, {
            type: 'line',
            data: {
                labels: orderedWeeks,
                datasets: [{
                    data: orderedWeeks.map(w => Math.max(...byWeekData[w].openToReviewRequest)),
                    ...maxOpts,
                },{
                    data: orderedWeeks.map(w => Math.min(...byWeekData[w].openToReviewRequest)),
                    ...minOpts,
                },{
                    data: orderedWeeks.map(w => byWeekData[w].openToReviewRequest.reduce((s, c) => s + c, 0) / byWeekData[w].openToReviewRequest.length),
                    ...avgOpts,
                }],
            },
            options: chartOpts,
        });

        const firstCtx = document.getElementById("firstReview").getContext('2d');
        const firstChart = new Chart(firstCtx, {
            type: 'line',
            data: {
                labels: orderedWeeks,
                datasets: [{
                    data: orderedWeeks.map(w => Math.max(...byWeekData[w].reviewRequestToFirst)),
                    ...maxOpts,
                },{
                    data: orderedWeeks.map(w => Math.min(...byWeekData[w].reviewRequestToFirst)),
                    ...minOpts,
                },{
                    data: orderedWeeks.map(w => byWeekData[w].reviewRequestToFirst.reduce((s, c) => s + c, 0) / byWeekData[w].reviewRequestToFirst.length),
                    ...avgOpts,
                }],
            },
            options: chartOpts,
        });

        const approvedCtx = document.getElementById("approvingReview").getContext('2d');
        const approvedChart = new Chart(approvedCtx, {
            type: 'line',
            data: {
                labels: orderedWeeks,
                datasets: [{
                    data: orderedWeeks.map(w => Math.max(...byWeekData[w].reviewRequestToApproved)),
                    ...maxOpts,
                },{
                    data: orderedWeeks.map(w => Math.min(...byWeekData[w].reviewRequestToApproved)),
                    ...minOpts,
                },{
                    data: orderedWeeks.map(w => byWeekData[w].reviewRequestToApproved.reduce((s, c) => s + c, 0) / byWeekData[w].reviewRequestToApproved.length),
                    ...avgOpts,
                }],
            },
            options: chartOpts,
        });

        </script>
    </body>
</html>
